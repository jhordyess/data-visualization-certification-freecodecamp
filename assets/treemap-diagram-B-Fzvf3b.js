import"./style-Ckw8JOKk.js";import*as l from"https://cdn.jsdelivr.net/npm/d3@7/+esm";const h={game:{key:"game",url:"https://cdn.freecodecamp.org/testable-projects-fcc/data/tree_map/video-game-sales-data.json",title:"Video Game Sales 🎮",description:"Top 100 Most Sold Video Games Grouped by Platform",categoryName:"Platform",valueName:"Sales"},movie:{key:"movie",url:"https://cdn.freecodecamp.org/testable-projects-fcc/data/tree_map/movie-data.json",title:"Movie Sales 🎥",description:"Top 100 Highest Grossing Movies Grouped By Genre",categoryName:"Genre",valueName:"Revenue"},kickstarter:{key:"kickstarter",url:"https://cdn.freecodecamp.org/testable-projects-fcc/data/tree_map/kickstarter-funding-data.json",title:"Kickstarter Pledges 🏦💰",description:"Top 100 Most Pledged Kickstarter Campaigns Grouped By Category",categoryName:"Category",valueName:"Pledged"}};let c=h.game;const{search:v}=new URL(window.location.href),u=new URLSearchParams(v);if(u.has("data")){const a=u.get("data");h[a]&&(c=h[a])}const m=949,y=640,b={top:20,right:20,bottom:30,left:40},k=async(a=c.url)=>await fetch(a).then(s=>s.json()),f=l.scaleOrdinal().range(l.schemeTableau10),w=l.select("#chart-container"),x=w.append("svg").attr("width",m).attr("height",y),$=()=>{document.getElementById("title").innerHTML=c.title,document.getElementById("description").innerHTML=c.description,document.getElementById(c.key+"Link").style.color="#2563eb"},T=({clientX:a,clientY:s},{name:o,category:r,value:t})=>{const e=l.select("#tooltip"),i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;let n=a+10;const d=s+window.scrollY-28,p=144;n+p+b.right>i&&(n=a-p-10),e.style("display","block").style("transform",`translate(${n}px,${d}px)`).attr("data-value",t).html(`${o}<br /><b>${c.categoryName}:</b> ${r}<br /><b>${c.valueName}:</b> ${t}`)},M=()=>l.select("#tooltip").style("display","none"),W=a=>{const o=l.treemap().size([m,y])(l.hierarchy(a).eachBefore(({data:t,parent:e})=>{t.id=(e?e.data.id+".":"")+t.name}).sum(({value:t})=>t).sort((t,e)=>e.height-t.height||e.value-t.value)),r=x.selectAll("g").data(o.leaves()).enter().append("g").attr("transform",({x0:t,y0:e})=>`translate(${t},${e})`).on("mousemove",(t,e)=>T(t,e.data)).on("mouseout",M);return r.append("rect").attr("class","tile").attr("width",({x1:t,x0:e})=>t-e).attr("height",({y1:t,y0:e})=>t-e).attr("stroke","white").attr("fill",({data:{category:t}})=>f(t)).attr("data-name",({data:{name:t}})=>t).attr("data-category",({data:{category:t}})=>t).attr("data-value",({data:{value:t}})=>t),r.append("foreignObject").attr("class","cursor-pointer").attr("width",({x1:t,x0:e})=>t-e).attr("height",({y1:t,y0:e})=>t-e).append("xhtml:div").attr("class","max-w-full max-h-full p-1 text-xs overflow-hidden overflow-ellipsis").html(({data:{name:t}})=>t),o.leaves()},j=a=>a.map(({data:{category:o}})=>o).filter((o,r,t)=>t.indexOf(o)===r),B=a=>{const o=Math.ceil(a.length/3),r=m/2,t={height:24,width:r/3,padding:8},e=t.height*o,i=w.append("svg").attr("id","legend").style("margin",`${t.padding}px auto -${t.padding}px`).attr("width",r).attr("height",e).selectAll("g").data(a).enter().append("g").attr("transform",(n,d)=>{const p=d%3*t.width,g=Math.floor(d/3)*t.height;return`translate(${p},${g})`});i.append("rect").attr("class","legend-item").attr("width",16).attr("height",16).attr("fill",n=>f(n)),i.append("text").attr("class","text-xs").attr("x",20).attr("y",14).text(n=>n)},G=async()=>{const a=await k();document.getElementById("spinner").style.display="none",document.getElementById("chart-container").style.display="block",$();const s=W(a);B(j(s))};G();
