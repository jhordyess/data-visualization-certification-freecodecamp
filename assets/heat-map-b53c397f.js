import"./style-3f9d7e1e.js";import*as o from"https://cdn.jsdelivr.net/npm/d3@7/+esm";const B="https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/global-temperature.json",b=896*2,d=512,s={top:20,right:20,bottom:30,left:65},F=396,y=20,S=30,g=["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffbf","#fee090","#fdae61","#f46d43","#d73027","#a50026"],T=async(a=B)=>await fetch(a).then(e=>e.json()),v=a=>new Intl.DateTimeFormat("en-US",{month:"long"}).format(new Date(0,a)),A=(a,e)=>new Intl.DateTimeFormat("en-US",{month:"long",year:"numeric"}).format(new Date(a,e)),x=a=>new Intl.NumberFormat("en-US",{style:"unit",unit:"celsius",maximumFractionDigits:1,minimumFractionDigits:1}).format(a),m=o.select("#chart-container").append("svg").attr("width",b).attr("height",d+y+S),h=o.scaleBand().range([s.left,b-s.right]),p=o.scaleBand().range([d-s.bottom,s.top]),l=o.scaleThreshold().range(g),I=({clientX:a,clientY:e},{year:t,month:r,variance:n},c)=>{const f=A(t,r-1),i=x(c+n),W=x(n),$=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;let u=a+15;const k=e-p.bandwidth()+window.scrollY,w=144;u+w+s.right>$&&(u=a-w-15),o.select("#tooltip").style("display","block").attr("data-year",t).html(`${f}<br/>${i}<br/>${W}`).style("transform",`translate(${u}px,${k}px)`)},V=()=>{o.select("#tooltip").style("display","none")},C=(a,e)=>{m.selectAll("rect").data(a).enter().append("rect").attr("data-month",({month:t})=>t-1).attr("data-year",({year:t})=>t).attr("data-temp",({variance:t})=>e+t).attr("x",({year:t})=>h(t)).attr("y",({month:t})=>p(t-1)).attr("width",h.bandwidth()).attr("height",p.bandwidth()).attr("class","hover:stroke-black cursor-pointer cell").attr("fill",({variance:t})=>l(e+t)).on("mouseover",(t,r)=>I(t,r,e)).on("mouseout",V)},E=()=>{const a=l.domain(),e=o.scaleBand().range([s.left,F]).domain(a).padding(1),t=o.axisBottom(e).tickValues(a).tickFormat(o.format(".1f"));m.append("g").attr("transform",`translate(0,${d+y})`).call(t);const r=g.map(n=>l.invertExtent(n));m.append("g").attr("id","legend").attr("transform",`translate(0,${d})`).selectAll("rect").data(r).enter().append("rect").attr("x",([n])=>e(n)).attr("y",0).attr("width",([n,c])=>c===void 0||n===void 0?0:e(c)-e(n)).attr("height",y).attr("fill",([n])=>l(n))},P=()=>{const a=o.axisBottom(h).tickValues(h.domain().filter(t=>t%10===0)),e=o.axisLeft(p).tickFormat(t=>v(t));m.append("g").attr("id","x-axis").attr("transform",`translate(0,${d-s.bottom})`).call(a),m.append("g").attr("id","y-axis").attr("transform",`translate(${s.left},0)`).call(e)},U=(a,e)=>{const t=a.map(({variance:i})=>e+i),[r,n]=[o.min(t),o.max(t)],c=(n-r)/g.length,f=[];for(let i=1;i<g.length;i++)f.push(r+i*c);return f},D=(a,e=0,t="")=>e>=a?t.split(",").map(Number):D(a,e+1,e+","+t),j=async()=>{const{monthlyVariance:a,baseTemperature:e}=await T();document.getElementById("spinner").style.display="none",document.getElementById("chart-container").style.display="block",h.domain(a.map(({year:t})=>t)),p.domain(D(12)),l.domain(U(a,e)),C(a,e),E(),P()};j();
